{"version":3,"file":"static/webpack/static/development/pages/index.js.0bf31fabeb6d4f9724cb.hot-update.js","sources":["webpack:///../node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js","webpack:///./pages/index.tsx"],"sourcesContent":["import _Object$defineProperty from \"../../core-js/object/define-property\";\nexport default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    _Object$defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import React from \"react\";\nimport Link from \"next/link\";\n\nimport getMicroFrontend from \"../src/get-micro-frontend\";\n\ntype Props = {\n    headerText?: string;\n    scripts: string;\n};\n\nconst SOURCE_URL = \"http://localhost:3001/?component=footer\";\n// const SOURCE_URL = \"https://nationalmap.gov.au\";\nclass Home extends React.Component<Props> {\n    static async getInitialProps(ctx: any) {\n        // async function parseHtmlNode(html: string): Promise<Document> {\n        //     const { JSDOM } = await import(\"jsdom\");\n        //     const { document: doc } = new JSDOM(html).window;\n        //     return doc;\n        // }\n        // async function parseHtmlBrowser(html: string): Promise<Document> {\n        //     const parser = new DOMParser();\n        //     const doc = parser.parseFromString(html, \"text/html\");\n        //     return doc;\n        // }\n        // const response = await fetch(SOURCE_URL);\n        // const text = await response.text();\n        // const doc = await (typeof window !== \"undefined\"\n        //     ? parseHtmlBrowser(text)\n        //     : parseHtmlNode(text));\n        // const scripts = [];\n        // const scriptTags = doc.querySelectorAll(\"script\");\n        // scriptTags.forEach(script => {\n        //     const newScript = {} as any;\n        //     for (let i = 0; i < script.attributes.length; i++) {\n        //         const attr = script.attributes.item(i);\n        //         if (attr.value) {\n        //             newScript[attr.name] = attr.value;\n        //         }\n        //     }\n        //     // if (script.src && script.src !== \"\") {\n        //     //     newScript.src = SOURCE_URL + \"/\" + script.src;\n        //     // }\n        //     newScript.innerHTML = script.innerHTML;\n        //     scripts.push(newScript);\n        // });\n        // scriptTags.forEach(script => script.parentElement.removeChild(script));\n        const { html, scripts } = await getMicroFrontend(SOURCE_URL);\n        return {\n            headerText: html,\n            scripts\n        };\n    }\n\n    onRefAdded = (element: HTMLDivElement) => {\n        if (element) {\n            const scripts = element.querySelectorAll(\"script\");\n\n            scripts.forEach(script => {\n                const newScript = document.createElement(\"script\");\n                script.text = script.innerHTML;\n                for (var i = script.attributes.length - 1; i >= 0; i--) {\n                    newScript.setAttribute(\n                        script.attributes[i].name,\n                        script.attributes[i].value\n                    );\n                }\n                script.parentNode.replaceChild(newScript, script);\n                console.log(`replaced ${newScript.src}`);\n            });\n        }\n    };\n\n    render() {\n        return (\n            <div>\n                <div\n                    ref={this.onRefAdded}\n                    dangerouslySetInnerHTML={{\n                        __html: this.props.headerText\n                    }}\n                />\n                <div>\n                    <button onClick={() => alert(\"hello\")}>hello</button>\n                    body 2\n                    <Link href=\"/otherpage\">\n                        <a>Go to other page</a>\n                    </Link>\n                </div>\n            </div>\n        );\n    }\n}\n\n// if (typeof window !== \"undefined\") {\n//     class Component extends HTMLElement {\n//         connectedCallback() {\n//             // this.attachShadow({ mode: \"open\" });\n//             const html = this.innerHTML;\n//             // this.innerHTML = \"\";\n//             // this.shadowRoot.innerHTML = html;\n//             // this.innerHTML = html;\n\n//             const scriptsJson = this.attributes[\"scripts\"].nodeValue;\n//             console.log(scriptsJson);\n//             const scripts = JSON.parse(scriptsJson);\n//             scripts.forEach(script => {\n//                 const scriptElement = document.createElement(\"script\");\n//                 Object.keys(script).forEach(attrKey => {\n//                     scriptElement[attrKey] = script[attrKey];\n//                 });\n//                 // scriptElement.innerHTML = \"alert('hello');\";\n//                 // this.shadowRoot.appendChild(scriptElement);\n//                 this.appendChild(scriptElement);\n//             });\n\n//             // this.moveSlots();\n//             // this.shadowRoot.appendChild(this);\n//         }\n//         moveSlots() {\n//             let slots = this.querySelectorAll(\"slot\");\n//             Array.from(slots).forEach(slot => {\n//                 // Move the slot's children back to their place in the light DOM.\n//                 Array.from(slot.childNodes).forEach(el => {\n//                     this.appendChild(el);\n//                 });\n//             });\n//         }\n//     }\n//     customElements.define(\"x-heyo\", Component);\n// }\n\nexport default Home;\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACdA;AACA;AAEA;AAOA;AACA;AACA;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;;;;;;AA7EA;;;;;;;;AAiCA;AACA;;;AADA;AAAA;AACA;AACA;AACA;AAFA;AACA;;;;;;;;;;;;;;;;;;AApCA;AAkFA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;;;;A","sourceRoot":""}